CREATE TABLE "comments" (
	"id" integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY (sequence name "comments_id_seq" INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START WITH 1 CACHE 1),
	"user_id" uuid NOT NULL,
	"comment" text NOT NULL,
	"response_id" uuid,
	"prompt_id" uuid,
	"score_id" uuid,
	"comment_id" integer,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE "quick_feedbacks" (
	"id" integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY (sequence name "quick_feedbacks_id_seq" INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START WITH 1 CACHE 1),
	"user_id" uuid NOT NULL,
	"response_id" uuid,
	"prompt_id" uuid,
	"score_id" uuid,
	"created_at" timestamp DEFAULT now() NOT NULL,
	"updated_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE "quick_feedbacks_quick_feedback_flags" (
	"quick_feedback_id" integer NOT NULL,
	"flag_id" integer NOT NULL,
	CONSTRAINT "quick_feedbacks_quick_feedback_flags_quick_feedback_id_flag_id_pk" PRIMARY KEY("quick_feedback_id","flag_id")
);
--> statement-breakpoint
ALTER TABLE "rss_articles" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
ALTER TABLE "user_answers" DISABLE ROW LEVEL SECURITY;--> statement-breakpoint
DROP TABLE "rss_articles" CASCADE;--> statement-breakpoint
DROP TABLE "user_answers" CASCADE;--> statement-breakpoint
ALTER TABLE "responses" ALTER COLUMN "model_host" SET NOT NULL;--> statement-breakpoint
ALTER TABLE "comments" ADD CONSTRAINT "comments_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "auth"."users"("id") ON DELETE set null ON UPDATE cascade;--> statement-breakpoint
ALTER TABLE "comments" ADD CONSTRAINT "comments_response_id_responses_id_fk" FOREIGN KEY ("response_id") REFERENCES "public"."responses"("id") ON DELETE cascade ON UPDATE cascade;--> statement-breakpoint
ALTER TABLE "comments" ADD CONSTRAINT "comments_prompt_id_prompts_id_fk" FOREIGN KEY ("prompt_id") REFERENCES "public"."prompts"("id") ON DELETE cascade ON UPDATE cascade;--> statement-breakpoint
ALTER TABLE "comments" ADD CONSTRAINT "comments_score_id_scores_id_fk" FOREIGN KEY ("score_id") REFERENCES "public"."scores"("id") ON DELETE cascade ON UPDATE cascade;--> statement-breakpoint
ALTER TABLE "comments" ADD CONSTRAINT "comments_comment_id_comments_id_fk" FOREIGN KEY ("comment_id") REFERENCES "public"."comments"("id") ON DELETE no action ON UPDATE no action;--> statement-breakpoint
ALTER TABLE "quick_feedbacks" ADD CONSTRAINT "quick_feedbacks_user_id_users_id_fk" FOREIGN KEY ("user_id") REFERENCES "auth"."users"("id") ON DELETE cascade ON UPDATE cascade;--> statement-breakpoint
ALTER TABLE "quick_feedbacks" ADD CONSTRAINT "quick_feedbacks_response_id_responses_id_fk" FOREIGN KEY ("response_id") REFERENCES "public"."responses"("id") ON DELETE cascade ON UPDATE cascade;--> statement-breakpoint
ALTER TABLE "quick_feedbacks" ADD CONSTRAINT "quick_feedbacks_prompt_id_prompts_id_fk" FOREIGN KEY ("prompt_id") REFERENCES "public"."prompts"("id") ON DELETE cascade ON UPDATE cascade;--> statement-breakpoint
ALTER TABLE "quick_feedbacks" ADD CONSTRAINT "quick_feedbacks_score_id_scores_id_fk" FOREIGN KEY ("score_id") REFERENCES "public"."scores"("id") ON DELETE cascade ON UPDATE cascade;--> statement-breakpoint
ALTER TABLE "quick_feedbacks_quick_feedback_flags" ADD CONSTRAINT "quick_feedbacks_quick_feedback_flags_quick_feedback_id_quick_feedbacks_id_fk" FOREIGN KEY ("quick_feedback_id") REFERENCES "public"."quick_feedbacks"("id") ON DELETE cascade ON UPDATE cascade;--> statement-breakpoint
ALTER TABLE "quick_feedbacks_quick_feedback_flags" ADD CONSTRAINT "quick_feedbacks_quick_feedback_flags_flag_id_review_flags_id_fk" FOREIGN KEY ("flag_id") REFERENCES "public"."review_flags"("id") ON DELETE cascade ON UPDATE cascade;