CREATE TABLE "hash_registrations" (
	"id" integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY (sequence name "hash_registrations_id_seq" INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START WITH 1 CACHE 1),
	"cid" text NOT NULL,
	"sha256" text NOT NULL,
	"signature" text,
	"signature_type" varchar(10) DEFAULT 'cid',
	"public_key" text,
	"key_type" varchar(50) DEFAULT 'secp256k1n',
	"uploader_id" uuid,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
CREATE TABLE "raw_data_registrations" (
	"id" integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY (sequence name "raw_data_registrations_id_seq" INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START WITH 1 CACHE 1),
	"cid" text NOT NULL,
	"sha256" text NOT NULL,
	"raw_data" text NOT NULL,
	"public_key" text,
	"uploader_id" uuid,
	"public" boolean DEFAULT false NOT NULL,
	"created_at" timestamp DEFAULT now() NOT NULL
);
--> statement-breakpoint
ALTER TABLE "evaluations" ALTER COLUMN "score" DROP DEFAULT;--> statement-breakpoint
ALTER TABLE "evaluations" ALTER COLUMN "score" DROP NOT NULL;--> statement-breakpoint
ALTER TABLE "prompts" ALTER COLUMN "file_id" DROP NOT NULL;--> statement-breakpoint
ALTER TABLE "prompts" ALTER COLUMN "options" DROP NOT NULL;--> statement-breakpoint
ALTER TABLE "prompts" ALTER COLUMN "answer_key" DROP NOT NULL;--> statement-breakpoint
ALTER TABLE "prompts" ALTER COLUMN "answer" DROP NOT NULL;--> statement-breakpoint
ALTER TABLE "prompts" ADD COLUMN "hash_sha256_registration" text;--> statement-breakpoint
ALTER TABLE "prompts" ADD COLUMN "hash_cid_registration" text;